# 現実的なコスト分析

## 問題: 現在の試算は楽観的すぎる

### Phase 1（100ユーザー）
```yaml
現在の想定: 10本/日投稿
現実的な数字: 3-5本/日（投稿率3-5%）

理由:
  - 新規ユーザーは様子見が多い
  - 動画投稿はハードル高い
  - 鶏卵問題（動画少ない→見る人少ない→投稿減る）

コスト影響:
  現在の想定: $0/月（無料枠内）
  → 変わらず $0/月 ✅
```

### Phase 2（1,000ユーザー）
```yaml
現在の想定: 500本/日投稿（投稿率50%）
現実的シナリオ3パターン:

【悲観シナリオ（投稿率3%）】
  投稿数: 30本/日
  30日蓄積: 900本 × 7MB = 6.3GB

  月額コスト:
    - Firebase: $5/月（軽い負荷）
    - S3: $0.15/月
    - CloudFront: $10/月（300GB転送）
  合計: $15/月 💰 非常に安い

【現実的シナリオ（投稿率10%）】
  投稿数: 100本/日
  30日蓄積: 3,000本 × 7MB = 21GB

  月額コスト:
    - Firebase: $10/月
    - S3: $0.5/月
    - CloudFront: $30/月（1TB転送）
  合計: $40.5/月 💰 許容範囲

【楽観シナリオ（投稿率20% = TikTok初期並）】
  投稿数: 200本/日
  30日蓄積: 6,000本 × 7MB = 42GB

  月額コスト:
    - Firebase: $15/月
    - S3: $1/月
    - CloudFront: $50/月（2TB転送）
  合計: $66/月 💰 まだ大丈夫

【現在の想定（投稿率50% = 非現実的）】
  投稿数: 500本/日
  30日蓄積: 15,000本 × 7MB = 105GB

  月額コスト:
    - Firebase: $20/月
    - S3: $2.5/月
    - CloudFront: $80/月（10TB転送）
  合計: $102.5/月 ⚠️ 高すぎ、達成困難
```

### Phase 3（10,000ユーザー）
```yaml
現実的シナリオ（投稿率10%）:
  投稿数: 1,000本/日
  30日蓄積: 30,000本 × 7MB = 210GB

  月額コスト:
    - Firebase: $50/月（Functions実行増）
    - S3: $5/月
    - CloudFront: $300/月（10TB転送）
    - AI監視（Vision API）: $50/月
  合計: $405/月

  収益化:
    有料ユーザー（転換率3%）: 300人 × $5/月 = $1,500/月
    広告収益（RPM $2）: 10,000視聴 × $2/1000 = $20/月
  合計収益: $1,520/月

  利益: $1,520 - $405 = $1,115/月 ✅ 黒字化可能
```

## Phase 2の現実的コスト結論

| シナリオ | 投稿率 | 投稿数/日 | 月額コスト | 達成難易度 |
|---------|-------|----------|-----------|-----------|
| 悲観 | 3% | 30本 | $15 | 簡単 |
| **現実的** | **10%** | **100本** | **$40** | **妥当** |
| 楽観 | 20% | 200本 | $66 | やや難 |
| 現在想定 | 50% | 500本 | $102 | 非現実的 |

## コスト爆発リスク

### CloudFrontの罠
```yaml
想定外のコスト要因:
  1. 視聴数 ≠ 投稿数
     - 人気動画は100回以上視聴される
     - 転送量は投稿数の10-50倍になる可能性

  2. リピート視聴
     - キャッシュ効かない場合、毎回転送
     - react-native-video-cacheが正しく動かないと破綻

  3. プリロード
     - 次の動画を事前ダウンロード
     - 転送量2倍になる
```

### 現実的な転送量計算
```yaml
Phase 2（1,000ユーザー、100本/日投稿）:

投稿転送: 100本/日 × 7MB × 30日 = 21GB

視聴転送（重要）:
  - DAU（日次アクティブ）: 30%（300人）
  - 1人あたり視聴: 10本/日
  - 視聴総数: 300人 × 10本 = 3,000本/日
  - キャッシュヒット率: 30%（楽観的）
  - 実転送: 3,000本 × 70% × 7MB = 14.7GB/日
  - 月間: 14.7GB × 30日 = 441GB

合計転送: 21GB + 441GB = 462GB/月

CloudFrontコスト:
  最初の10TB: $0.085/GB
  462GB × $0.085 = $39/月

結論: $40/月は妥当 ✅
```

## 最悪シナリオ

### バイラル化した場合（Phase 2.5）
```yaml
突然のバズ: 10,000ユーザー（1ヶ月で10倍成長）

投稿率10%: 1,000本/日
DAU 30%: 3,000人
視聴: 3,000人 × 20本/日 = 60,000本/日

転送量:
  60,000本 × 70% × 7MB = 294GB/日
  月間: 8,820GB = 8.8TB

月額コスト:
  - Firebase: $100/月（負荷急増）
  - S3: $5/月
  - CloudFront: $750/月（8.8TB）
  - 緊急対応: $50/月
合計: $905/月 ⚠️ 赤字リスク

対策なしの場合:
  収益化前に破綻する可能性
```

## コスト爆発を防ぐ対策

### 1. キャッシュ戦略の徹底
```yaml
必須実装:
  ✅ react-native-video-cache 完全導入
  ✅ CloudFront Cache-Control: max-age=2592000（30日）
  ✅ プリロードは次の1本のみ（現在2-3本は危険）

目標:
  キャッシュヒット率70%以上
  → 転送量1/3削減
```

### 2. 段階的な画質調整
```yaml
Phase 1: 720p, 1.5Mbps（現在の想定）
Phase 2: 動的画質
  - Wi-Fi: 720p, 1.5Mbps
  - 4G: 540p, 1Mbps（自動ダウングレード）
  - 3G: 360p, 0.5Mbps

コスト削減効果:
  4Gユーザー50%が540pにダウングレード
  → 転送量25%削減
```

### 3. コスト上限アラート
```yaml
AWS Budgets設定:
  Phase 1: $10/月でアラート
  Phase 2: $50/月でアラート、$100で緊急停止検討
  Phase 3: $500/月でアラート

Firebase Budgets:
  Phase 2: $30/月でアラート
```

### 4. 緊急コスト削減策
```yaml
コストが想定の2倍になった場合:
  1. 動画保管期間を30日→7日に短縮
  2. 画質を720p→540pに一時ダウングレード
  3. プリロード停止
  4. 新規投稿を一時制限（1日1本まで）
  5. 有料化前倒し
```

## 結論: コストは管理可能

### ✅ 良いニュース
```yaml
Phase 1: $0/月（確実に無料枠内）
Phase 2（現実的）: $40/月（小遣いで払える）
Phase 3: $400/月（収益化で黒字化可能）

スタートアップとして健全な数字
```

### ⚠️ 注意点
```yaml
1. 現在の試算（$102/月）は非現実的に楽観的
2. バイラル化リスクに備えたコスト上限設定必須
3. キャッシュ戦略が失敗すると破綻
4. 転送量が最大のコスト要因（投稿数ではない）
```

### 🎯 推奨アクション
```yaml
1. Phase 2想定を見直す
   現在: 500本/日投稿
   推奨: 100本/日投稿（投稿率10%）

2. コスト試算を3シナリオ化
   悲観: $15/月
   現実的: $40/月
   楽観: $66/月

3. AWS/Firebase Budgets設定を最初から
   → コスト爆発を事前に検知
```
